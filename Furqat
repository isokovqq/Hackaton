credit_history = pd.read_parquet('credit_history.parquet')
df = credit_history

# 1. Remove redundant index column
if "Unnamed: 0" in df.columns:
    df = df.drop(columns=["Unnamed: 0"])

# 2. Fill missing delinquency values with 0
if "num_delinquencies_2yrs" in df.columns:
    df['num_delinquencies_2yrs'] = df['num_delinquencies_2yrs'].fillna(0)
else:
    print("Column 'num_delinquencies_2yrs' not found!")

# 3. Rename customer_number → customer_id
if "customer_number" in df.columns:
    df = df.rename(columns={"customer_number": "customer_id"})
else:
    print("Column 'customer_number' not found!")

df['oldest_account_age_months'] = (
    df['oldest_account_age_months']
        .astype(str)
        .str.replace("'", " ")
        .str.replace('"', " ")
        .str.strip()
)

df['oldest_account_age_months'] = pd.to_numeric(df['oldest_account_age_months'], errors='coerce').fillna(0)
df['oldest_account_age_months'].dtype

df.to_csv(r"C:\Users\furqa\OneDrive\Desktop\python\cleaned_credit_history.csv", index=False)





df1 = pd.read_csv(r"C:\Users\furqa\OneDrive\Desktop\python\corrected\geographic_data.csv")
# 1. Remove Unnamed index column
unnamed_cols = [col for col in df1.columns if "unnamed" in col.lower()]
df1 = df1.drop(columns=unnamed_cols)

# 2. Rename id → customer_id
rename_map = {}
for col in df1.columns:
    if col.lower() == "id":
        rename_map[col] = "customer_id"
df1 = df1.rename(columns=rename_map)

# 3. Remove spaces & apostrophes from ALL string values
df1 = df1.applymap(lambda x: x.strip().replace("'", "") if isinstance(x, str) else x)

# 4. Convert numeric-looking columns back to numeric
for col in df1.columns:
    df1[col] = pd.to_numeric(df1[col], errors="ignore")

# 5. Fill existing NaN values with 0
df1 = df1.fillna(0)
df1.to_csv(r"C:\Users\furqa\OneDrive\Desktop\python\cleaned_geographic_data.csv", index=False)
